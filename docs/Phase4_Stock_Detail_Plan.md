# Phase 4.4 실행 계획: 로빈후드 스타일 기업 상세 뷰어 개발 (고도화 버전)

## 1. 개요
본 문서는 사용자가 특정 종목의 가격 변동(OHLC), 기술적 지표(이동평균), 그리고 다양한 타임프레임(일/주/월봉)을 분석할 수 있는 **로빈후드(Robinhood) 스타일 기업 상세 페이지** 구축 계획을 정의합니다. 특히 사용자의 설정에 따라 전문적인 차트 정보를 유연하게 토글하고, 다크/라이트 테마에 완벽히 대응하는 인터페이스를 제공하는 데 중점을 둡니다.

---

## 2. UI/UX 디자인 및 차트 기능

### 2.1 다중 차트 모드 (Hybrid Charting)
*   **라인 모드 (Basic)**: 로빈후드 기본 스타일의 매끄러운 선형 차트 (종가 기준).
*   **캔들 모드 (Advanced)**: OHLC(시가, 고가, 저가, 종가)를 이용한 일본식 양봉/음봉 차트.
*   **타임프레임 지원**:
    *   **일봉 (Daily)**: 최근 1년치 일간 데이터.
    *   **주봉 (Weekly)**: 주간 단위 데이터 집계.
    *   **월봉 (Monthly)**: 월간 단위 데이터 집계.

### 2.2 기술적 지표 (Technical Indicators)
*   **이동평균선 (MA)**: 주가의 흐름을 파악하기 위한 MA5, MA20, MA60, MA120선 지원.
*   **지표 렌더링**: 주가 차트 위에 오버레이(Overlay) 형태로 부드럽게 렌더링.

### 2.3 차트 설정 제어 (Display Toggles)
*   사용자는 **Settings** 패널 또는 차트 상단 툴바에서 다음 정보를 개별적으로 켜고 끌 수 있음:
    *   캔들스틱 vs 라인 차트 전환
    *   이동평균선 표시 여부 (개별 MA선 선택 가능)
    *   거래량(Volume) 보조 지표 표시 여부

### 2.4 다크/라이트 테마 최적화 (Theme Responsiveness) - [High Priority]
*   **실시간 테마 감지**: `useSettingsStore`의 테마 상태에 따라 차트 엔진(`lightweight-charts`)의 모든 색상 옵션을 즉각 업데이트.
*   **다크 모드 (Dark Mode)**:
    *   배경: `#000000`, 그리드: `#1E1E1E` (매우 어둡게).
    *   상승: `#00C805` (네온 그린), 하락: `#FF5000` (네온 레드).
*   **라이트 모드 (Light Mode)**:
    *   배경: `#FFFFFF`, 그리드: `#F0F0F0` (은은하게).
    *   상승: `#16a34a` (진한 초록), 하락: `#dc2626` (진한 빨강).
*   **텍스트 및 십자선**: 테마별 대비를 고려한 가변 색상 적용 (White/Black).

---

## 3. 핵심 구현 항목

### 3.1 차트 시각화 고도화 (`lightweight-charts`)
*   `LineSeries`와 `CandlestickSeries`를 동적으로 전환하는 로직 구현.
*   `MA` 데이터를 위한 별도의 `LineSeries` 오버레이 추가.
*   테마 전환 시 `chart.applyOptions()`를 통한 실시간 스타일링 적용.

### 3.2 백엔드 데이터 집계 (Aggregation)
*   **일봉**: 기존 `TB_STOCK_PRICE` 데이터 사용.
*   **주봉/월봉**: 프론트엔드 집계 유틸리티 구현.
    *   *주봉*: 한 주(월~금)의 [시작일 시가, 고가, 저가, 종료일 종가] 산출.

### 3.3 사용자 설정 영속화 (`useSettingsStore`)
*   차트 표시 설정 및 선택된 테마 정보를 Zustand 스토어에서 통합 관리.

---

## 4. 상세 개발 일정 (5일)

### 1일차: API 연동 및 데이터 집계 로직
*   [ ] 종목별 OHLC 가격 히스토리 API 연동.
*   [ ] 일봉 데이터를 주봉/월봉으로 변환하는 집계(Aggregation) 함수 구현.

### 2일차: 하이브리드 차트 엔진 및 테마 시스템 구축
*   [ ] `lightweight-charts`를 이용한 라인/캔들 전환 기능 개발.
*   [ ] **다크/라이트 모드 테마 스위칭 로직 차트 엔진에 통합.**

### 3일차: 기술적 지표 및 오버레이
*   [ ] 이동평균선(MA5, 20, 60, 120) 계산 및 차트 렌더링.
*   [ ] 차트 설정 제어용 UI(Toggle Switch) 개발.

### 4일차: 기업 정보 및 재무 스태츠 (Responsive UI)
*   [ ] 로빈후드 스타일의 Key Statistics 그리드 및 About 섹션 구현.
*   [ ] 분기별 실적 시각화 (Recharts) - 테마별 막대 컬러 적용.

### 5일차: 최종 폴리싱 및 설정 연동
*   [ ] 테마 전환 시 애니메이션 효과 및 차트 리사이징 최적화.
*   [ ] 전역 설정 스토어 연동 및 사용자 피드백 반영 최종 테스트.

---

## 5. 기술 스택
*   **Chart**: `lightweight-charts` (캔들/라인/테마 옵션 지원)
*   **State**: `useSettingsStore` (Zustand)를 통한 테마 및 환경 설정 관리.
*   **집계**: `date-fns` 활용.
