# Phase 3 실행 계획 (Action Plan): 고급 전략 구현

## 1. 개요
본 문서는 `docs/Implementation_Roadmap.md`에 정의된 Phase 3 (고급 전략)의 미완료 작업들에 대한 구체적인 실행 계획을 정의합니다. 단순 필터링을 넘어 통계적 기법(Z-Score)을 활용한 정교한 스코어링, 섹터 로테이션, 그리고 주식 외 자산(채권, 현금)을 포함하는 동적 자산배분 엔진 구축을 목표로 합니다.

## 2. 대상 작업 목표
- **3.1 멀티팩터 전략**: Z-Score 정규화 및 통합 스코어링 엔진
- **3.2 섹터 로테이션**: 업종별 상대 강도 분석 및 모멘텀 전략
- **3.3 동적 자산배분**: 주식/채권/현금 간의 듀얼 모멘텀 및 변동성 조절
- **3.4 리스크 패리티**: 자산별 리스크 기여도 기반 동일 리스크 배분

---

## 3. 세부 구현 계획

### 3.1 멀티팩터 스코어링 엔진 (Z-Score)

#### 3.1.1 Z-Score 정규화 로직
- **목표**: 단위가 다른 여러 지표(PER, ROE 등)를 동일한 기준으로 비교 가능하도록 표준화
- **구현 항목**:
  - `FactorScoringService`: 특정 시점의 전체 유니버스 데이터에 대한 평균(Mean) 및 표준편차(StdDev) 계산
  - 이상치(Outlier) 처리: Winsorization(상하위 1% 값 제한) 적용 후 Z-Score 산출
  - 방향성 처리: 낮은 게 좋은 지표(PER, PBR)는 Z-Score에 -1을 곱하여 정렬 방향 일치

#### 3.1.2 통합 스코어링 및 앙상블 전략
- **목표**: 개별 팩터 점수를 가중 결합하여 최종 순위 도출
- **구현 항목**:
  - `CompositeScoringStrategy`: 사용자 정의 가중치(Value 40%, Momentum 30%, Quality 30% 등)에 따른 합산 점수 계산
  - `MultiFactorStrategy`: 합산 점수 상위 종목을 선정하여 리밸런싱 주문 생성

### 3.2 섹터 로테이션 (Sector Rotation)

#### 3.2.1 섹터 모멘텀 분석
- **목표**: 업종별 평균 수익률 및 상대 강도 지표 산출
- **구현 항목**:
  - `SectorAnalysisService`: GICS/KSIC 섹터별 구성 종목의 평균 12개월 모멘텀 계산
  - `RelativeStrengthIndex`: 시장(KOSPI) 대비 섹터의 초과 수익률(Alpha) 계산

#### 3.2.2 섹터 리밸런싱 전략
- **목표**: 모멘텀이 강한 상위 N개 섹터를 선정하고 해당 섹터 내 우량주 매수
- **구현 항목**:
  - `SectorRotationStrategy`: 매월 말 섹터 순위를 갱신하고, 하위 섹터는 전량 매도, 상위 섹터는 신규 진입/비중 확대

### 3.3 동적 자산배분 (Dynamic Asset Allocation)

#### 3.3.1 다중 자산군 통합
- **목표**: 국내주식(KOSPI/KOSDAQ) 외에 채권(ETF), 현금 자산군 지원
- **구현 항목**:
  - `AssetClassManager`: 자산군별 대표 종목(Ticker) 매핑 및 데이터 연동
  - `CashManagement`: 현금 자산에 대한 가상 수익률(예: CD금리) 적용 로직

#### 3.3.2 동적 배분 로직 (Dual Momentum & Vol Targeting)
- **목표**: 시장 상황에 따라 위험자산(주식)과 안전자산(채권/현금) 비중 조절
- **구현 항목**:
  - **듀얼 모멘텀**: 절대 모멘텀(수익률 > 0)과 상대 모멘텀(타 자산군 대비 우위) 동시 검증
  - **변동성 타겟팅**: 포트폴리오의 최근 변동성을 측정하여 목표 변동성(예: 10%)을 유지하도록 현금 비중 조절

### 3.4 리스크 패리티 (Risk Parity)

#### 3.4.1 리스크 기여도 계산
- **목표**: 각 자산이 전체 포트폴리오 리스크에 기여하는 정도를 균등화
- **구현 항목**:
  - `RiskParityOptimizer`: 자산 간 상관계수(Correlation) 및 변동성을 활용한 가중치 최적화 엔진
  - 수치 최적화(Numerical Optimization) 알고리즘 적용 (또는 근사치 계산 로직)

---

## 4. DB 및 도메인 모델 변경 사항
- **TB_SECTOR_ANALYSIS**: 섹터별 일일/월간 지표 저장 테이블 신설
- **TB_FACTOR_SCORE**: 종목별/날짜별 팩터 Z-Score 결과 저장 (백테스트 가속화용 캐시)
- **BacktestRequest 확장**: 자산군 설정 및 고급 배분 옵션(Risk Parity 등) 파라미터 추가

## 5. 검증 및 테스트 계획
1. **스코어링 정확도 검증**: 수동 계산된 Z-Score와 시스템 산출값이 일치하는지 검증 (단위 테스트)
2. **동적 배분 동작 확인**: 하락장에서 안전자산(채권/현금) 비중이 계획대로 확대되는지 로그 분석
3. **성능 테스트**: 멀티팩터 Z-Score 계산 시 전체 유니버스(2,000+ 종목) 처리 속도 측정 및 인덱스 최적화

## 6. 진행 일정 (예상)
- **1-2주차**: Z-Score 스코어링 엔진 및 멀티팩터 전략 고도화 (3.1)
- **3-4주차**: 섹터 모멘텀 분석 및 로테이션 전략 구현 (3.2)
- **5-7주차**: 다중 자산군 지원 및 동적 자산배분/리스크 패리티 엔진 구현 (3.3, 3.4)
