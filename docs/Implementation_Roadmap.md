# 구현 계획 (Roadmap)

> **목적**: Stock-MSA 시스템의 향후 개발 방향 및 우선순위

## 📅 전체 로드맵

```
Phase 0: 데이터 수집 인프라 ✅ (완료)
Phase 1: 데이터 품질 검증 🚧 (90% 완료)
Phase 2: 백테스팅 엔진 ✅ (완료)
Phase 3: 고급 전략 ✅ (완료)
Phase 4: 프론트엔드 대시보드 ⏳ (계획)
Phase 5: 머신러닝 전략 ⏳ (계획)
Phase 6: 프로덕션 준비 ⏳ (계획)
Phase 7: 실시간 시스템 ⏳ (계획)
```

---

## Phase 1: 데이터 품질 검증 (진행중)

**목표**: 수집된 데이터의 정합성 및 완전성 확보

### 1.1 데이터 정합성 검증 ✅ (완료)
**주요 성과**:
- [x] 필수 필드 누락 검사 (TotalAsset, Revenue 등 `FinanceValidationService` 구현)
- [x] 대차대조표 등식 검증 (자산 = 부채 + 자본, 오차율 0.1% 이내)
- [x] 이상치 탐지 (전분기 대비 자산/매출 변동폭 1000% 이상 탐지 및 `WARN_OUTLIER` 부여)
- [x] 검증 상태 관리 (`VERIFIED`, `ERROR_MISSING`, `ERROR_IDENTITY` 등 상태 세분화)

### 1.2 성능 모니터링 🚧 (진행중)
**우선순위**: 중간  
**예상 기간**: 1주

**작업 내용**:
- [x] DART API Rate Limiting 구현 (Sliding Window 방식, 분당 1,000회 제한 준수)
- [ ] 배치 처리 단계별 상세 시간 측정 및 로깅
- [ ] Prometheus/Grafana 연동을 통한 서비스 메트릭 시각화
- [ ] 슬로우 쿼리 감지 및 인덱스 최적화

### 1.3 데이터 보완 및 최적화 🚧 (진행중)
**우선순위**: 중간  
**예상 기간**: 1주

**작업 내용**:
- [x] DART API 일일 한도 대응 (분기별 개별 수집 API 구현으로 호출 수 75% 절감)
- [x] DART Corp Code DB 기반 관리 및 상장사 매핑 자동화 (`SectorUpdateBatch`)
- [ ] 주가 데이터 누락일 탐지 및 자동 재수집 로직
- [ ] 기술적 지표 계산 성공률 향상 (히스토리 부족 종목 처리 개선)

---

## Phase 2: 백테스팅 엔진 ✅ (완료)

**목표**: 전략 검증 및 성과 분석 완성

### 2.1 리스크 지표 구현 ✅ (완료)
**주요 성과**:
- [x] 연환산 수익률 (CAGR) 및 총 수익률 산출
- [x] 최대 낙폭 (MDD) 계산 로직 구현 (`PerformanceCalculationService`)
- [x] 샤프 비율 (Sharpe Ratio, 무위험 수익률 0% 가정)
- [x] 연환산 변동성 (Volatility) 및 승률(Win Rate) 산출
- [x] 매수/매도 이력 기반 실현 수익 분석

### 2.2 전략 관리 및 최적화 ✅ (완료)
**우선순위**: 중간  
**예상 기간**: 2주

**작업 내용**:
- [x] 백테스팅 시뮬레이션 및 결과 저장/조회 API (`BacktestController`)
- [x] 포트폴리오 스냅샷 (보유 종목, 자산 구성) 관리
- [x] 전략 비교 기능: 여러 전략 동시 실행 및 성과 비교 테이블/차트
- [x] 전략 최적화: 파라미터 그리드 서치를 통한 최적 파라미터 자동 탐색

### 2.3 거래 비용 반영 ✅ (완료)
**우선순위**: 높음  
**예상 기간**: 1주

**작업 내용**:
- [x] 매수/매도 수수료 (Trading Fee) 반영
- [x] 증권거래세 등 세금 (Tax) 반영
- [x] 슬리피지 (Slippage) 모델링 적용 (거래량 대비 가격 변동 모델, 고정 슬리피지 모델)
- [x] 거래 제약 구현 (최소 거래 단위 1주, 단일 종목 최대 비중 제한, 잔고 부족 방어 로직)

---

## Phase 3: 고급 전략 ✅ (완료)

**목표**: 다양한 퀀트 전략 구현

### 3.1 멀티팩터 전략 ✅ (완료)
**우선순위**: 높음  
**예상 기간**: 2주

**작업 내용**:
- [x] 팩터 필터링 엔진 (`CustomFilterCriteria`, `UniverseFilterService`)
- [x] 가치(Value), 모멘텀(Momentum), 저변동성(Low Volatility) 기본 전략
- [x] 팩터별 Z-Score 정규화 및 통합 스코어링 로직 (`FactorScoringService`)
- [x] 동적 가중치 기반 멀티팩터 앙상블 전략 (`MultiFactorStrategy`)

### 3.2 섹터 로테이션 ✅ (완료)
**주요 성과**:
- [x] GICS 기반 `SectorType` 정의 및 KSIC 매핑 엔진 구축
- [x] 한국표준산업분류(KSIC) 기반 업종 자동 수집 배치 (`SectorUpdateBatch`)
- [x] 섹터별 모멘텀 분석 및 상대 강도 지표 산출 (`SectorAnalysisService`)
- [x] 상위 섹터 자동 선택 및 리밸런싱 전략 구현 (`SectorRotationStrategy`)

### 3.3 동적 자산배분 ✅ (완료)
**우선순위**: 높음  
**예상 기간**: 3주

**작업 내용**:
- [x] 자산군 정의: 국내주식(KOSPI/KOSDAQ), 채권, 현금 (시뮬레이션 엔진 연동)
- [x] 배분 전략: 듀얼 모멘텀, 변동성 타겟팅 (`AssetAllocationStrategy`)
- [x] 리밸런싱: 월간/분기별 또는 임계값 기반(5% 이탈 시)

### 3.4 리스크 패리티 ✅ (완료)
**우선순위**: 중간  
**예상 기간**: 2주

**작업 내용**:
- [x] 자산별 리스크 기여도 계산 및 동일 리스크 배분 로직 (`AssetAllocationStrategy.RISK_PARITY`)
- [x] 목표 변동성 달성을 위한 레버리지 조정 (Inverse Volatility 적용)

---

## Phase 4: 프론트엔드 대시보드 (계획)

**목표**: 시스템 전체 데이터 및 백테스팅 결과를 직관적으로 시각화

### 4.1 포트폴리오 스냅샷 뷰어 ⏳
**우선순위**: 높음  
**예상 기간**: 2주

**작업 내용**:
- [ ] 시계열 자산(현금 + 주식) 변동 라인 차트 구현 (Recharts/Chart.js 등 활용)
- [ ] 포트폴리오 편입 종목 및 섹터 비중 파이 차트
- [ ] 백테스트 파라미터(슬리피지, 제약조건 등) 요약 패널

### 4.2 전략 비교 대시보드 ⏳
**우선순위**: 높음  
**예상 기간**: 2주

**작업 내용**:
- [ ] 2개 이상의 백테스팅 전략(`CompareStrategiesResponse`) 병렬 차트 렌더링
- [ ] CAGR, MDD, Sharpe 등 핵심 성과 지표(KPI) 테이블 및 레이더 차트 (Radar Chart)
- [ ] 최적화(Grid Search) 랭킹 보드 (Top 10 파라미터 조합 리스트)

### 4.3 데이터 품질 모니터링 뷰 ⏳
**우선순위**: 중간  
**예상 기간**: 1주

**작업 내용**:
- [ ] DART API 수집 현황 및 검증 통과(VERIFIED) 비율 대시보드
- [ ] 에러 종목 및 미수집 데이터 모니터링 경고 위젯

---

## Phase 5: 머신러닝 전략 (계획)

**목표**: AI 기반 투자 전략

### 5.1 데이터 준비 및 모델 개발 ⏳
**우선순위**: 중간
**예상 기간**: 4주

**작업 내용**:
- [ ] 피처 엔지니어링 (기술적/재무 지표 조합 및 시계열 특성 추출)
- [ ] 수익률 예측(회귀) 및 상승/하락 예측(분류) 모델 개발 (XGBoost, LSTM 등)
- [ ] 강화학습(DQN, PPO) 기반 포트폴리오 최적화

### 5.2 모델 평가 및 배포 ⏳
**우선순위**: 중간
**예상 기간**: 2주

**작업 내용**:
- [ ] Walk-Forward 검증 및 과적합 방지
- [ ] TensorFlow Serving 기반 모델 서빙 API
- [ ] A/B 테스팅 및 모델 재학습 파이프라인

---

## Phase 6: 프로덕션 준비 (계획)

**목표**: 안정적인 운영 환경 구축

### 6.1 모니터링 및 로깅 ⏳
- [ ] ELK Stack(Elasticsearch, Logstash, Kibana) 기반 중앙 로깅
- [ ] Prometheus 및 Grafana 대시보드 구축
- [ ] Slack/Email 장애 알림 및 헬스 체크

### 6.2 보안 강화 ⏳
- [ ] JWT 기반 인증 및 RBAC(Role Based Access Control)
- [ ] API Rate Limiting 및 API 키 보안 관리
- [ ] 데이터 암호화 및 HTTPS 적용

### 6.3 성능 최적화 ⏳
- [ ] Redis 기반 자주 조회되는 데이터 캐싱
- [ ] 쿼리 튜닝, 파티셔닝 및 비동기 배치 작업화

### 6.4 CI/CD 파이프라인 ⏳
- [ ] GitHub Actions를 이용한 자동 빌드/테스트/배포(Docker)
- [ ] 블루-그린 배포 및 자동 롤백 시스템

---

## Phase 7: 실시간 시스템 (계획)

**목표**: 실시간 데이터 수집 및 자동 매매

### 7.1 실시간 데이터 수집 ⏳
**우선순위**: 높음  
**예상 기간**: 4주

**작업 내용**:
- [ ] WebSocket 연동 (한국투자증권 API, 키움증권 API)
- [ ] 실시간 주가(체결가, 호가) 및 거래량 수집
- [ ] 실시간 기술적/재무 지표 업데이트
- [ ] Kafka 기반 이벤트 스트리밍 및 알림

### 7.2 자동 매매 연동 ⏳
**우선순위**: 높음  
**예상 기간**: 4주

**작업 내용**:
- [ ] 증권사 API 주문 실행 (시장가, 지정가, 조건부 주문)
- [ ] 주문 상태 추적 및 체결 확인
- [ ] 실시간 포지션 관리 및 손익 계산

### 7.3 리스크 관리 ⏳
**우선순위**: 높음  
**예상 기간**: 2주

**작업 내용**:
- [ ] 자동 손절(Stop-loss)/익절(Take-profit) 주문
- [ ] 단일 종목 및 섹터별 최대 비중 제한
- [ ] 일일 최대 손실 제한(Loss Cut) 및 거래 중단 시스템

---

## 우선순위 요약

### 높음 (1-2주 내)
1. Phase 1: 데이터 보완 로직 및 성능 모니터링
2. Phase 4: 포트폴리오 스냅샷 및 전략 비교 UI 개발

### 중간 (1-2개월 내)
1. Phase 5: 데이터 준비 및 머신러닝 피처 엔지니어링
2. Phase 6: 프로덕션 모니터링 기초 구축

### 낮음 (3-6개월 내)
1. Phase 7: 실시간 시스템 기초
2. Phase 6: CI/CD 및 보안 강화

---

## 참고 자료

- [구현 현황](./Implementation_Status.md)
- [검증 가이드](./Testing_and_Verification.md)
- [README](../README.md)
